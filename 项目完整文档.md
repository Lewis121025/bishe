# 基于数据挖掘的上市公司财政补贴与高管超额薪酬研究

更新日期：2026-02-13  
适用仓库：`/Users/lewis/毕业论文`

---

## 1. 文档目的

本文档用于完整说明本项目的研究问题、数据来源、变量构造、模型设定、复现流程、结果产出与维护规范，作为论文写作、答辩演示与后续迭代的统一说明文档。

---

## 2. 研究主题与核心问题

论文题目：**基于数据挖掘的上市公司财政补贴与高管超额薪酬研究**

核心问题：

1. 财政补贴是否显著提高上市公司高管超额薪酬？
2. 管理层权力是否在“财政补贴 → 超额薪酬”之间发挥中介作用？
3. 该效应是否存在产权异质性（国有/非国有）？
4. 该效应是否在管制行业、央地国企中呈现机制差异？
5. 数据挖掘方法能否提升对超额薪酬的预测与解释能力？

---

## 3. 研究框架

### 3.1 计量经济学主线

1. 估计期望薪酬并构造超额薪酬（Overpay）  
2. 基准回归检验补贴效应（模型3）  
3. 中介回归与 Sobel 检验（模型4、模型5）  
4. 分组异质性检验（国有/非国有）  
5. 机制检验（管制行业/非管制行业；央企/地方国企）  
6. 稳健性检验（6 组）

### 3.2 数据挖掘主线

1. Lasso 变量筛选  
2. 随机森林回归/分类  
3. XGBoost + SHAP 可解释性  
4. 决策树风险路径  
5. K-Means 企业画像  
6. 模型性能对比

---

## 4. 数据来源与样本口径

数据来源：CSMAR（国泰安）数据库。  
样本区间：2003-2024 年 A 股上市公司（剔除金融行业）。  
当前回归口径最终样本量：**52,402** 个公司-年观测值。

原始数据位于 `data/`，主要包括：

- 营业收入、净利润、总资产、无形资产、行业
- 政府补助（两文件拼接）
- 高管前三名薪酬总和
- 公司治理（两职合一、管理层持股、董事会规模、独董比例）
- 总经理任期
- 总负债
- 所在地与公司性质
- 第一大股东持股比例与实际控制人性质

---

## 5. 变量定义与构造口径

### 5.1 被解释变量

- `lnCEOpay`：高管前三名薪酬总和取对数
- `Overpay`：超额薪酬，定义为实际薪酬对数减去期望薪酬对数

### 5.2 核心解释变量

- `lnSubsidy`：政府补助对数（仅对正补助取对数，非正补助置缺失）
- `lnSubsidy1p`：稳健性替代变量，`ln(1 + 补助)`

### 5.3 中介变量

- `Power`：管理层权力综合指标  
  使用 `Tenure`、`Dual`、`Boardsize`、`Insider`、`Mgshder` 标准化后进行 PCA，取第一主成分

### 5.4 控制变量

- `Roa`：净利润 / 总资产
- `Lever`：总负债 / 总资产
- `Top1`：第一大股东持股比例
- `Zone`：区域虚拟变量（东部=0，中西部=1）
- 行业固定效应、年份固定效应

### 5.5 分组变量

- `IsSOE`：产权性质（国有/非国有）
- `RegulatedIndustry`：管制行业（行业大类 `B/D/G/I/N`）
- `IsCentralSOE`：央企/地方国企（实控人代码 `2100=央企`，`2120=地方国企`）

---

## 6. 模型设定

### 6.1 期望薪酬模型（模型1）

`lnCEOpay = α₀ + α₁ lnSale + α₂ Roa + α₃ IA + α₄ Zone + ΣIndustry + ε`

### 6.2 基准回归（模型3）

`Overpay = α₀ + α₁ lnSubsidy + Controls + ΣIndustry + ΣYear + ε`

### 6.3 中介检验（模型4、模型5）

- 模型4：  
`Overpay = α₀ + α₁ lnSubsidy + α₂ Power + Controls + ΣIndustry + ΣYear + ε`
- 模型5：  
`Power = α₀ + α₁ lnSubsidy + Controls + ΣIndustry + ΣYear + ε`

说明：

- 主回归标准误采用**公司层面聚类稳健标准误**
- 中介效应采用 Baron & Kenny 逐步法 + Sobel 检验

### 6.4 稳健性检验（6组）

1. 替换被解释变量为 `lnCEOpay`
2. 缩短样本期（2010-2020）
3. 剔除补贴极值（5%-95%）
4. 制造业子样本
5. 替换解释变量为 `lnSubsidy1p`
6. 使用滞后一期补贴 `lnSubsidy_l1`

---

## 7. 项目目录说明

```text
/Users/lewis/毕业论文
├── data/                         # 原始 .dta 数据
├── processed_data/               # 转换后的 .csv 数据
├── scripts/
│   ├── convert_data.py           # .dta → .csv
│   ├── validate_conversion.py    # 转换校验
│   ├── regression_analysis.py    # 计量分析主脚本
│   ├── generate_tables.py        # 论文格式回归表
│   └── ml_analysis.py            # 数据挖掘分析
├── results/
│   ├── regression_dataset.csv
│   ├── regression_tables.txt
│   ├── 论文实证结果摘要.md
│   ├── model_comparison.csv
│   └── fig*.png
├── kaiti.md
├── 参考论文笔记_刘剑民2019.md
└── README.md
```

---

## 8. 环境配置

### 8.1 前置要求

- Python 3.10+（本地已验证 venv 环境可运行）
- Git LFS（必须，原始数据为 LFS 管理）
- macOS 运行 XGBoost 时需 `libomp`

### 8.2 初始化命令

```bash
cd /Users/lewis/毕业论文

# 拉取 LFS 数据
git lfs install
git lfs pull

# macOS 依赖（仅首次）
brew install libomp

# Python 环境
python3 -m venv venv
source venv/bin/activate
pip install pandas pyreadstat numpy statsmodels scikit-learn xgboost shap matplotlib seaborn scipy
```

---

## 9. 一键复现流程

按以下顺序执行：

```bash
cd /Users/lewis/毕业论文
source venv/bin/activate

python scripts/convert_data.py
python scripts/validate_conversion.py
python scripts/regression_analysis.py
python scripts/generate_tables.py
python scripts/ml_analysis.py
```

说明：

- 第 1-2 步用于从原始 `.dta` 生成并验证 `processed_data/*.csv`
- 第 3 步输出核心回归日志并写出 `results/regression_dataset.csv`
- 第 4 步生成论文风格回归表 `results/regression_tables.txt`
- 第 5 步生成机器学习图表与 `results/model_comparison.csv`

---

## 10. 当前实证结果（2026-02-13 版）

### 10.1 主回归

- 模型(3)：`lnSubsidy = 0.0395***`
- 模型(4)：`lnSubsidy = 0.0420***`，`Power` 不显著
- 模型(5)：`lnSubsidy = 0.0957***`

结论：财政补贴与高管超额薪酬显著正相关。

### 10.2 中介效应

- Sobel `Z = 0.0531`，`p = 0.9577`
- 间接效应占总效应约 `0.06%`

结论：当前口径下管理层权力中介效应不成立。

### 10.3 异质性与机制

- 产权：非国有样本补贴效应强于国有样本
- 行业：非管制行业效应强于管制行业
- 央地：地方国企显著，央企不显著（可识别比例约 73.64%）

### 10.4 稳健性

6 组稳健性检验中，补贴系数均保持正向显著，结论稳健。

---

## 11. 结果文件说明

### 11.1 论文核心文件

- `results/regression_tables.txt`：论文可直接引用的结构化回归表
- `results/论文实证结果摘要.md`：中文结论摘要（适合写作整合）
- `results/regression_dataset.csv`：分析过程变量齐全的数据集

### 11.2 数据挖掘文件

- `results/model_comparison.csv`：模型性能对比表
- `results/fig1_lasso_path.png` - `results/fig8_model_comparison.png`：可视化图表

---

## 12. 常见问题（FAQ）

### Q1：运行时报 CSV 读取异常，只有几行文本？

通常是 LFS 指针未拉取。执行：

```bash
git lfs install
git lfs pull
```

### Q2：`xgboost` 在 macOS 报 `libomp` 相关错误？

执行：

```bash
brew install libomp
```

### Q3：如何只更新回归结果，不跑 ML？

执行：

```bash
python scripts/regression_analysis.py
python scripts/generate_tables.py
```

---

## 13. 维护与版本建议

1. 保持“数据口径变更必记录”：样本区间、过滤规则、变量定义变更需写入文档
2. 回归口径调整后，需同步更新：
   - `results/regression_tables.txt`
   - `results/论文实证结果摘要.md`
   - 本文档第 10 节结果摘要
3. 若新增机制或稳健性检验，优先复用 `regression_analysis.py` 中现有建模函数，避免重复实现

---

## 14. 参考材料

- 开题报告：`/Users/lewis/毕业论文/kaiti.md`
- 参考论文笔记：`/Users/lewis/毕业论文/参考论文笔记_刘剑民2019.md`
- 结果摘要：`/Users/lewis/毕业论文/results/论文实证结果摘要.md`

